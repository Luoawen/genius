<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="utf-8"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="initial-scale=1.0, maximum-scale=1.0, user-scalable=no"/>
    <title></title>
    <script th:src="@{/js/location.js}" type="text/javascript"></script>
    <script th:src="@{/js/jquery-2.0.0.min.js}" type="text/javascript"></script>
    <script th:inline="javascript">


        function getUrlParam(url, name) {
            var reg = new RegExp("(^|\\?|&)" + name + "=([^&]*)(\\s|&|$)", "i");
            var r = url.match(reg);
            if (r != null) {
                return decodeURIComponent(r[2]);
            }
            return '';
        }

        function getQueryString(name) {
            var reg = new RegExp("(^|&)" + name + "=([^&]*)(&|$)", "i");
            var reg_rewrite = new RegExp("(^|/)" + name + "/([^/]*)(/|$)", "i");
            var r = window.location.search.substr(1).match(reg);
            var q = window.location.pathname.substr(1).match(reg_rewrite);
            if(r != null){
                return unescape(r[2]);
            }else if(q != null){
                return unescape(q[2]);
            }else{
                return null;
            }
        }

        $(function () {

            var userId = [[${userId}]];
            var templateId = getQueryString("templateId");
            $.ajax({
                type: 'get',
                url: "/wechat/share/code",
                dataType: 'json',
                data: [{
                    userId: userId,
                    templateId: templateId
                }]
                success: function (data) {
                    // $('#userName').val(data.data.content);
                    $("#content").html(data.data.content);
                },
                error: function (XMLHttpRequest, textStatus, errorThrown) {
                    alert("网络超时，请重试");
                }
            });

        });
    </script>
</head>
<body>
<p th:text="'Hello, ' + ${userId} + '!'" />
<div id="content"></div>
</body>
</html>